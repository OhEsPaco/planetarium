<html>
<head>
  <style>
    html, body { width: 100%; height: 100%; background: #000; color: #fff; }
    body { margin: 0; overflow: hidden; }
    canvas { width: 100%; height: 100%; }
  </style>
</head>
<body>
<script src='js/three.min.js'></script>

<script>
    // CONSTANTS =========================================================
    var simulation_speed = 1;   
    var last_simulation_speed=1;
    var min_simulation_speed = -20;
    var max_simulation_speed = +20;
    var control_speed=20;
    // PLANETS =========================================================
    var sun, mercury, venus, earth, mars;
    var moon, phobos, deimos;

    var stars;
    // CAMERA, SCENE, RENDERER... ========================================
    var camera, scene, renderer;

    init();
    animation();
    

    function translation(orbitado, orbitante){
        
        var x=orbitado.mesh.position.x + orbitante.orbit_radius * Math.sin(orbitante.angle);
        var y=orbitado.mesh.position.y + orbitante.orbit_radius * Math.cos(orbitante.angle);

        orbitante.mesh.position.x=x;
        orbitante.mesh.position.y=y;

        orbitante.angle+=simulation_speed*orbitante.translation_speed;
        
    }

    function rotation(orbitante){
      orbitante.mesh.rotation.z += simulation_speed*orbitante.rotation_speed;
      orbitante.mesh.rotation.x += simulation_speed*orbitante.rotation_speed*0.1;

    }

    function updateStar(star){
        star.mesh.position.x+=star.movement_speed * Math.cos(star.angle) * simulation_speed;
        star.mesh.position.y+=star.movement_speed * Math.sin(star.angle) * simulation_speed;
    }



    function init(){
      camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 4000);
      camera.position.z = 3500;
      camera.position.x = 0;
      camera.position.y = 0;

      scene = new THREE.Scene();
      star={
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(5, 1), new THREE.MeshBasicMaterial({ color: 0xA9A9A9 , wireframe:true})),
        movement_speed: 30,
        angle:1,
        
      };
      star.mesh.position.z=-300;
      //scene.add(star.mesh);
      //Sun
      sun = {
        orbit_radius: 0, 
        translation_speed: 0, 
        rotation_speed: 0.001,
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(160, 1), new THREE.MeshBasicMaterial({ color: 0xffde00 , wireframe:true}))
      };

      scene.add(sun.mesh);
      
      //Mercury
      mercury = {
        orbit_radius: 698, 
        translation_speed: 0.04892,
        rotation_speed: 0.02, 
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(48, 1), new THREE.MeshBasicMaterial({ color: 0xA9A9A9 , wireframe:true}))
      };
      scene.add(mercury.mesh);

      //Venus
      venus = {
        orbit_radius: 1089, 
        translation_speed: 0.03502,
        rotation_speed: -0.015, 
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(121, 1), new THREE.MeshBasicMaterial({ color: 0x7A5230 , wireframe:true}))
      };

      scene.add(venus.mesh);

      //Earth
      earth = {
        orbit_radius: 1520, 
        translation_speed: 0.02978,
        rotation_speed: 0.09, 
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(127, 1), new THREE.MeshBasicMaterial({ color: 0x5383d1 , wireframe:true}))
      };

      moon = {
        orbit_radius: 200, 
        translation_speed: 0.05, 
        rotation_speed: 0.05,
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(20, 1), new THREE.MeshBasicMaterial({ color: 0xbb40d1 , wireframe:true}))
      };

      scene.add(earth.mesh);
      scene.add(moon.mesh);

      //Mars

      mars = {
        orbit_radius: 2492, 
        translation_speed: 0.02407,
        rotation_speed: 0.08, 
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(67, 1), new THREE.MeshBasicMaterial({ color: 0xCC0000 , wireframe:true}))
      };

      phobos = {
        orbit_radius: 120, 
        translation_speed: 0.07,
        rotation_speed: 0.01, 
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(15, 1), new THREE.MeshBasicMaterial({ color: 0x800080 , wireframe:true}))
      };

      deimos = {
        orbit_radius: 150, 
        translation_speed: 0.04,
        rotation_speed: 0.01, 
        angle:0, 
        mesh: new THREE.Mesh(new THREE.IcosahedronGeometry(10, 1), new THREE.MeshBasicMaterial({ color: 0x008000 , wireframe:true}))
      };

      scene.add(mars.mesh);
      scene.add(phobos.mesh);
      scene.add(deimos.mesh);


      renderer = new THREE.WebGLRenderer({antialias:true});
      renderer.setSize( window.innerWidth, window.innerHeight );
      document.body.appendChild(renderer.domElement) ;
    }  

    function animation(){
      window.requestAnimationFrame(animation);
     // updateStar(star);
      translation(sun, mercury);
      translation(sun, venus);
      translation(sun, earth);
      translation(sun, mars);

      translation(earth, moon);

      translation(mars, phobos);
      translation(mars, deimos);

      rotation(sun);
      rotation(earth);
      rotation(moon);
      rotation(mercury);
      rotation(venus);
      rotation(mars);
      rotation(phobos);
      rotation(deimos);
        
      renderer.render(scene, camera);  
    }   

    document.addEventListener("keydown", function (event) {
      if (event.defaultPrevented) {
        return; // Do nothing if the event was already processed
      }
      switch (event.key) {
        case "ArrowDown":
          simulation_speed=simulation_speed-0.3;
          if(simulation_speed<min_simulation_speed){
            simulation_speed=min_simulation_speed;
          }
        break;
        
        case "ArrowUp":
        simulation_speed=simulation_speed+0.3;
          if(simulation_speed>max_simulation_speed){
            simulation_speed=max_simulation_speed;
          }
        break;

        case "w":
          camera.position.y+=control_speed;
         
        break;

        case "s":
          camera.position.y-=control_speed;
          
        break;

        case "a":
          camera.position.x-=control_speed;
        
        break;

        case "d":
          camera.position.x+=control_speed;
       
        break;

        case "q":
          camera.position.z+=control_speed;
          if(camera.position.z>3950){
            camera.position.z=3950;
          }
        break;
        
        case "e":
          camera.position.z-=control_speed;

          if(camera.position.z<200){
            camera.position.z=200;
          }
        break;
        case "z":
        if(simulation_speed==0){
          simulation_speed=last_simulation_speed;
        }else{
          last_simulation_speed=simulation_speed;
          simulation_speed=0;
        }
        
        break;

        
    
        default:
          return; // Quit when this doesn't handle the key event.
        }

        // Cancel the default action to avoid it being handled twice
        event.preventDefault();
      }, true);
      // the last option dispatches the event to the listener first,
      // then dispatches event to window
  

</script>
</body>
</html>
